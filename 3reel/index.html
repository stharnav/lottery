<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Slot Machine</title>

<style>
  body {
    margin: 0;
    height: 100vh;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    background: radial-gradient(circle at center, #151515, #000);
    font-family: 'Poppins', sans-serif;
    color: white;
    background-image: url('images/fut.jpg');
  background-size: cover;
  background-repeat: no-repeat;
  background-position: center;
  }

  h1 {
    color: gold;
    font-size: 3rem;
    margin-bottom: 35px;
    text-shadow: 0 0 18px gold;
  }

  .machine {
  display: flex;
  gap: 40px;           
  padding: 40px 50px; 
  border-radius: 30px;
  border: 6px solid gold;
      background-image: url('images/4519.jpg');
  background-size: cover;
  background-repeat: no-repeat;
  background-position: center;
  box-shadow: 0 0 80px rgba(255,215,0,0.6);
}

.reel {
  width: 300px;       
  height: 400px;      
  overflow: hidden;
  border: 5px solid #333;
  border-radius: 25px;
  background: #000;
  position: relative;
}

  .symbols {
    position: absolute;
    width: 100%;
    top: 0;
  }


  .symbol {
 height: 400px;           
  display: flex;           
  justify-content: center;  
  align-items: center;      
  transition: none !important;
  opacity: 1 !important;
  filter: none !important;
}

.buttons {
  margin-top: 50px;
  display: flex;
  gap: 25px;
}

button {
  padding: 18px 28px;  
  font-size: 1.5rem;
  border-radius: 15px;
}

  button:hover {
    transform: scale(1.08);
    background: #ffe55c;
  }

  .message {
    margin-top: 30px;
    font-size: 1.6rem;
    font-weight: bold;
  }

  .popup {
  display: none;
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: rgba(0,0,0,0.9);
  backdrop-filter: blur(5px);
  justify-content: center;
  align-items: center;
  z-index: 999;
}

.popup-content {
  position: relative;
  width: 80%;               
  max-width: 800px;          
  padding: 60px 80px;
  border-radius: 25px;
  text-align: center;
  color: white;
  font-size: 3rem;          
  background: url('images/grunge-style-purple-pattern-background.jpg') center/cover no-repeat;
  border: 6px solid gold;
  box-shadow: 0 0 100px gold;
}

#popupMessage {
  white-space: normal;      
  font-size: 4rem;           
  text-align: center;
  text-shadow: 0 0 15px gold;
  line-height: 1.5;          
}


.close {
  position: absolute;
  top: 15px;
  right: 25px;
  font-size: 3.5rem;
  cursor: pointer;
  color: gold;
}

.close:hover {
  color: #ffe55c;
}

.glow {
  box-shadow: 0 0 40px gold, 0 0 80px gold inset;
  border-color: gold;
  transition: box-shadow 0.2s ease-in-out;
}
</style>
</head>

<body>
<h1>Slot Machine</h1>

<div class="machine">
  <div class="reel"><div class="symbols"></div></div>
  <div class="reel"><div class="symbols"></div></div>
  <div class="reel"><div class="symbols"></div></div>
</div>

<div class="buttons">
  <button id="spin1">Spin 1</button>
  <button id="spin2">Spin 2</button>
  <button id="spin3">Spin 3</button>
</div>

<div class="message" id="message"></div>
<div id="popup" class="popup">
  <div class="popup-content">
    <span id="closePopup" class="close">&times;</span>
    <h1>You Win</h1>
    <h2 id="popupMessage"></h2>
  </div>
</div>
<script>
const reelImages = [
  [ // Reel 1
    ['images/ear.png', 10],
    ['images/power.png', 40],
    ['images/power.png', 40],
    ['images/power.png', 40],
    ['images/phone.png', 50] 
  ],
  [ // Reel 2
    ['images/ear.png', 50],
    ['images/power.png', 40],
    ['images/power.png', 40],
    ['images/power.png', 40],
    ['images/phone.png', 10] 
  ],
  [ // Reel 3
    ['images/ear.png', 10],
    ['images/power.png', 40],
    ['images/power.png', 40],
    ['images/power.png', 40],
    ['images/phone.png', 50] 
  ]
];
const reels = document.querySelectorAll('.reel .symbols');
const message = document.getElementById('message');
const buttons = [spin1, spin2, spin3];

function fillReel(reel, reelIndex) {
  reel.innerHTML = "";
  const symbolsList = reelImages[reelIndex];

  function pickWeightedSymbol() {
    const totalWeight = symbolsList.reduce((sum, item) => sum + item[1], 0);
    let rand = Math.random() * totalWeight;
    for (const [img, weight] of symbolsList) {
      if (rand < weight) return img;
      rand -= weight;
    }
    return symbolsList[0][0]; 
  }

  for (let i = 0; i < 40; i++) {
    const s = pickWeightedSymbol();
    const d = document.createElement("div");
    d.className = "symbol";

    const img = document.createElement("img");
    img.src = s;
    img.style.width = '250px';
    img.style.height = '250px';
    img.style.objectFit = 'contain';
    d.appendChild(img);

    reel.appendChild(d);
  }
}


reels.forEach((reel, index) => fillReel(reel, index));

reels.forEach(fillReel);

function spinReel(reel, reelIndex, duration = 4000) {
  const symbolHeight = 300; 
  const totalSymbols = reel.children.length;
  const fullHeight = symbolHeight * totalSymbols;
  

  const parent = reel.parentElement;
  const clone = reel.cloneNode(true);
  clone.style.top = `-${fullHeight}px`;
  parent.appendChild(clone);

  const extraRotations = 5; 
  const totalDistance = fullHeight * (3 + extraRotations);

  let start = null;

  return new Promise(resolve => {
    function animate(timestamp) {
      if (!start) start = timestamp;
      const elapsed = timestamp - start;
      const progress = Math.min(elapsed / duration, 1);
      const ease = 1 - Math.pow(1 - progress, 4); 
      const move = ease * totalDistance;

      reel.style.top = `${move % fullHeight}px`;
      clone.style.top = `${(move % fullHeight) - fullHeight}px`;

      parent.classList.add("glow");  


      if (progress < 1) {
        requestAnimationFrame(animate);
      } else {

        const index = Math.floor((move % fullHeight) / symbolHeight);
        const finalDiv = reel.children[index];
        const finalImgSrc = finalDiv.querySelector("img").src;

        reel.innerHTML = "";
        const d = document.createElement("div");
        d.className = "symbol";
        const img = document.createElement("img");
        img.src = finalImgSrc;
        img.style.width = '300px';
        img.style.height = '300px';
        img.style.objectFit = 'contain';
        d.appendChild(img);
        reel.appendChild(d);

        clone.remove();
        reel.style.top = "0px";
        //parent.classList.remove("glow");
        resolve(finalImgSrc); 
      }
    }
    requestAnimationFrame(animate);
  });
}




async function spinNReels(n) {
  buttons.forEach(b => (b.disabled = true));
  message.textContent = "";

  const results = [];
  for (let i = 0; i < n; i++) {
    const duration = 5600 + i * 700;
    results[i] = await spinReel(reels[i], i, duration);
  }

  checkWin(results);
  buttons.forEach(b => (b.disabled = false));
}


function checkWin(r) {
  const popup = document.getElementById("popup");
  const popupMessage = document.getElementById("popupMessage");
  popupMessage.innerHTML = "";

  r.forEach(imgSrc => {
    const img = document.createElement("img");
    img.src = imgSrc;
    img.style.width = "250px";
    img.style.height = "250px";
    img.style.margin = "0 10px";
    img.style.objectFit = "contain";
    popupMessage.appendChild(img);
  });

  popup.style.display = "flex";

  document.getElementById("closePopup").onclick = () => {
    popup.style.display = "none";
  }

  popup.onclick = (e) => {
    if (e.target === popup) popup.style.display = "none";
    window.location.reload();
  }
}




spin1.onclick = () => spinNReels(1);
spin2.onclick = () => spinNReels(2);
spin3.onclick = () => spinNReels(3);
</script>
</body>
</html>
